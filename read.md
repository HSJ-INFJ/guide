```md
# 眼科分类与分诊系统 API 文档

v1.0.1
缓存暂时使用字典，后续更换redis
## 1. 急诊分诊接口

### 接口说明
根据患者症状和分类结果进行急诊分级，提供就诊建议和自我护理指导。

### 请求
- **方法**：`POST`
- **路径**：`/triage/`
- **请求头**：
  ```http
  Content-Type: application/json
  ```

### 请求体参数
| 参数名                | 类型     | 必填 |                描述                     |
| `session_id`          | string  | 是 | 分类接口返回的结果ID                       |
| `pain_description`    | string  | 否 | 疼痛描述（如"剧烈眼痛"）                   |
| `vision_changes`      | array   | 否 | 视力变化列表 如["视力急剧下降", "眼前黑影"] |
| `duration_hours`      | integer | 是 |    症状持续时间（小时）                    |
| `associated_symptoms` | array   | 否 | 伴随症状列表（如["头痛", "恶心"]）         |

为了使患者能够准确提供分诊所需信息，前端应提供以下交互元素：

​疼痛描述​（单选）：
无疼痛    轻微不适    中度疼痛    剧烈疼痛
​视力变化​（多选）：
视力正常   视力逐渐下降   视力急剧下降   视力突然完全丧失   看东西模糊   看东西重影   眼前有黑影   闪光感
​症状持续时间​（下拉选择）：
小于6小时  6-24小时 1-3天 3天以上
​伴随症状​（多选）：
无   眼红   分泌物多   畏光   流泪   异物感   头痛   恶心呕吐   眼部外伤   化学物质进入眼睛
### 请求体示例
```json
{
  "session_id": "123e4567-e89b-12d3-a456-426614174000",
  "pain_description": "剧烈眼痛",
  "vision_changes": ["视力突然完全丧失"],
  "duration_hours": 2,
  "associated_symptoms": ["头痛", "呕吐"]
}
```

### 成功响应（200 OK）
```json
{
  "session_id": "123e4567-e89b-12d3-a456-426614174000",
  "recommended_department": {
    "department_id": 102,
    "department_name": "青光眼科",
    "disease_name": "急性闭角型青光眼",
    "confidence": 0.92
  },
  "triage_result": {
    "level": 1,
    "reason": "可能危及视力的急症",
    "suggested_time": "立即就诊",
    "self_care_advice": [
      "保持平静，避免揉眼",
      "如为化学伤，立即用大量清水冲洗眼睛至少15分钟",
      "避免自行用药",
      "请家人或朋友陪同立即前往急诊"
    ]
  }
}
```

## 2. 其他核心接口

### 2.1 疾病分类与科室推荐
- **方法**：`POST`
- **路径**：`/classify/`
- **请求体**：
  ```json
  {
    "symptoms": ["视力模糊", "眼痛"]
  }
  ```
- **响应**：
  ```json
  {
    "success": true,
    "result_id": "生成的唯一ID",
    "classification": {
      "disease": "青光眼",
      "confidence": 0.92
    },
    "recommended_department": {
      "department_id": 102,
      "department_name": "青光眼科",
      "disease_name": "青光眼",
      "confidence": 0.86
    }
  }
  ```

### 2.2 获取缓存结果
- **方法**：`GET`
- **路径**：`/classify/result/<result_id>`
- **响应**：
  ```json
  {
    "success": true,
    "result_id": "123e4567-e89b-12d3-a456-426614174000",
    "classification": { /* 同分类结果 */ },
    "recommended_department": { /* 同科室推荐 */ },
    "symptoms": ["视力模糊", "眼痛"],
    "cached_at": "2025-08-28T19:10:00.000Z"
  }
  ```

## 3. 急诊级别说明
| 级别 | 紧急程度 | 建议就诊时间 | 适用场景 |
|------|----------|--------------|----------|
| 1    | 极高     | 立即就诊     | 视力完全丧失、化学伤、外伤后视力明显下降 |
| 2    | 高       | 今天内就诊   | 视力急剧下降、眼部剧痛、眼前黑影/闪光 |
| 3    | 中       | 24小时内就诊 | 视力逐渐下降、眼红伴分泌物、新复视 |
| 4    | 低       | 48小时内就诊 | 常规眼科问题 |

## 4. 自我护理建议示例
| 级别 | 建议 |
|------|------|
| 1级 | 保持平静，避免揉眼<br>化学伤立即冲洗15分钟 |
| 2级 | 避免驾驶车辆<br>避免强光刺激 |
| 3级 | 可用湿毛巾冷敷<br>避免戴隐形眼镜 |
| 4级 | 保持眼部清洁<br>避免长时间用眼 |

## 5. 注意事项
1. `session_id`有效期：**10分钟**
2. 急诊分诊需在症状分类后尽快调用
3. 提供越详细的症状描述，分诊结果越准确
```